# WeHelp

## How to run this project

1.  Intall expo on your mobile device and install npm on your computer.

2.  ```shell
    git clone https://github.com/dliang090222/WeHelp
    ```
3.  ```shell
    cd WeHelp/UI
    ```
4.  ```shell
    npm install
    ```
5.  ```shell
    npm start
    ```
6.  scan the QR code using your mobile device.

## How to debug on server

server logs in /tmp/wehelp.l.log
if you want to rerun it:
1. \```shell
   sudo su

    2. check if there is an existing process:
    ```shell
    ps -ef | grep daphne

3.  kill this process "daphne server.asgi:application ..."
    ```shell
    kill {pid}
    ```
4.  ```shell
    cd /home/yao090222/WeHelp/server
    ```
5.  ```shell
    source venv/bin/activate
    ```
6.  make sure docker is running redis on port 6379
    ```shell
    sudo lsof -i -P -n | grep LISTEN
    ```
7.  if not:
    ```shell
    sudo systemctl start docker
    sudo docker run -p 6379:6379 -d redis:5
    ```
8.  run the server
    ```shell
    nohup daphne server.asgi:application -p 80 -b 0 &> /tmp/wehelp.l.log &
    ```
9.  exit imediatly, don't do anything else as root


## How to Generate Documentation in JavaScript

1.  Install documentation.js using npm

    ```shell
    npm install -g documentation
    ```

2.  Write your documentaion in each js file following this format:

    ```javascript
    /**
     * 
     * Description of the function body
     *
     * @export
     * @param {type} param1 Description of param1
     * @param {type} param2 Description of param2
     * @return {number} Description of return value
     */
    export function template(param1, param2) {
       let ret;
       return ret;
    }
    ```

3.  Generate the documentations and append them to README.md

    Execute the following command under the directory where contains README.md

    ```shell
    documentation readme UI/app.js UI/src/pages/* UI/src/components/* -s "Front-end API" -g
    ```

## Front-end API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [App](#app)
    -   [Parameters](#parameters)
-   [ChatBox](#chatbox)
    -   [Parameters](#parameters-1)
-   [MapObject](#mapobject)
    -   [Parameters](#parameters-2)
-   [PageHeader](#pageheader)
    -   [Parameters](#parameters-3)
-   [PageNavigation](#pagenavigation)
    -   [Parameters](#parameters-4)
-   [UserContext](#usercontext)
-   [ChatPage](#chatpage)
    -   [Parameters](#parameters-5)
-   [checkLocationPermission](#checklocationpermission)
    -   [Parameters](#parameters-6)
-   [HomePage](#homepage)
    -   [Parameters](#parameters-7)
-   [HomeMainPage](#homemainpage)
    -   [Parameters](#parameters-8)
-   [SearchField](#searchfield)
    -   [Parameters](#parameters-9)
-   [CardField](#cardfield)
    -   [Parameters](#parameters-10)
-   [LoginPage](#loginpage)
    -   [Parameters](#parameters-11)
-   [MessagePage](#messagepage)
    -   [Parameters](#parameters-12)
-   [ChatList](#chatlist)
    -   [Parameters](#parameters-13)
-   [PublishPage](#publishpage)
    -   [Parameters](#parameters-14)
-   [publish](#publish)
    -   [Parameters](#parameters-15)
-   [checkImagePermission](#checkimagepermission)
    -   [Parameters](#parameters-16)
-   [ImagePicker](#imagepicker)
    -   [Parameters](#parameters-17)
-   [TaskDetailPage](#taskdetailpage)
    -   [Parameters](#parameters-18)
-   [TaskPage](#taskpage)
    -   [Parameters](#parameters-19)
-   [TaskMainPage](#taskmainpage)
    -   [Parameters](#parameters-20)
-   [TaskCard](#taskcard)
    -   [Parameters](#parameters-21)
-   [UserDetailPage](#userdetailpage)
    -   [Parameters](#parameters-22)
-   [getUser](#getuser)
    -   [Parameters](#parameters-23)
-   [UserPage](#userpage)
    -   [Parameters](#parameters-24)

### App

[UI/app.js:17-669](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/app.js#L17-L669 "Source code on GitHub")

App.js acts as a subject in the Observer Pattern to receive and process data from the server.
There are multiple EventListener and Websocket to listen to the new messages, new tasks, and new users events from the server.
As soon as there are new data coming from the server, App.js will notify the observers which are different funtional Pages.
Then, each page will rerender their components using their own methods

#### Parameters

-   `none`  

Returns **Component** => Render LoginPage component or PageNavigation component based on the user's login status.

### ChatBox

[UI/src/components/ChatBox.js:30-58](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/components/ChatBox.js#L30-L58 "Source code on GitHub")

ChatBox imports react-native-gifted-chat. 
It will rerender and update new messages as soon as chatList in App.js updates and chatPage is notified.
It then passes an array of messages to gifted chat. Gifted chat will generate an interactive chat window.

#### Parameters

-   `props` **{chat: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object), navigation: [object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** <br>
    1. props.chat is a chat object and one element of chatList in App.js.
     props.chat =  {
              'updating': boolean
              'chatID': number
              'avatar': string
              'name': string, the other user's name
              'UID': number, the other user's UID
              'comment': string, last_message
              'datetime': datetime of last_message, format in %Y-%m-%d %H:%M:%S
              'messages': [{'UID', 'message'}*], sorted
             }
    2. props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a ChatBox Component

### MapObject

[UI/src/components/MapObject.js:19-67](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/components/MapObject.js#L19-L67 "Source code on GitHub")

Shows a map. origin is the current user's location, destination is the target user's location.
If both origin and destination are not null, the map will draw the route between the origin and destination.

#### Parameters

-   `props` **{origin: {coords: {latitude: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number), longitude: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)}}, destination: {coords: {latitude: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number), longitude: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)}}}** <br>
    1. props.origin is a location object with values of latitude and longitude
    2. props.destination is a location object with values of latitude and longitude

Returns **Component** => Render a MapObject Component

### PageHeader

[UI/src/components/PageHeader.js:16-34](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/components/PageHeader.js#L16-L34 "Source code on GitHub")

A customized page header is used across most of the pages in this application.

#### Parameters

-   `props` **{leftComp: Component, centerComp: Component, rightComp: Component}** <br>
    1. props.leftComp
    2. props.centerComp
    3. props.rightComp

Returns **Component** => Render a PageHeader Component with leftComp, centerComp, rightComp if applicable

### PageNavigation

[UI/src/components/PageNavigation.js:25-34](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/components/PageNavigation.js#L25-L34 "Source code on GitHub")

A navigation container contains stack and tab navigation logic.
It is the fundamental navigation logic of this application 
that connects the HomePage, TaskPage, PublishPage, MessagePage, and UserPage.

#### Parameters

-   `none`  

Returns **Component** => Render a PageNavigation component with tab bar and page navigation logic for the whole application.

### UserContext

[UI/src/components/UserContext.js:8-8](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/components/UserContext.js#L8-L8 "Source code on GitHub")

A global context that is used to pass user, chatList, taskList in App.js to all observer pages.
As soon as this UserContext in App.js changes, all children use this UserContext will rerender.

Type: Context

### ChatPage

[UI/src/pages/ChatPage.js:30-96](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/ChatPage.js#L30-L96 "Source code on GitHub")

ChatPage will is an extended page of HomePage, TaskDetailPage, and MessagePage.
It shows the MapObject and ChatBox for interactive user chatting experience.
It is also an observer that will rerender if the chatList in the App.js changed.

#### Parameters

-   `props` **{route: {params: {chat: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}}}** <br>
    props.route.params.chat = {
              'updating': boolean
              'chatID': number
              'avatar': string
              'name': string, the other user's name
              'UID': number, the other user's UID
              'comment': string, last_message
              'datetime': datetime of last_message, format in %Y-%m-%d %H:%M:%S
              'messages': [{'UID', 'message'}*], sorted
             }

Returns **Component** => Render a ChatPage Component that consists of a MapObject and a ChatBox

### checkLocationPermission

[UI/src/pages/ChatPage.js:104-113](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/ChatPage.js#L104-L113 "Source code on GitHub")

It will check whether the application is allowed to acess location in the device.

#### Parameters

-   `none`  

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

### HomePage

[UI/src/pages/HomePage.js:22-31](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/HomePage.js#L22-L31 "Source code on GitHub")

HomePage create the basic stack navigation logic in the HomePage section
and render the contents of HomeMainPage, TaskDetailPage, UserDetailPage, and ChatPage.
These four pages will be redirected to each other if the corresponding button is trigged.

#### Parameters

-   `none`  

Returns **Component** => Render a HomePage Component with navigation logic

### HomeMainPage

[UI/src/pages/HomePage.js:43-84](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/HomePage.js#L43-L84 "Source code on GitHub")

HomeMainPage mainly consists of taskCard as child components to show available tasks information.
HomeMainPage is one of the observer under the subject App.js in the Observer Pattern.
The HomeMainPage use "useContext" function to listern to the global UserContext data provided by App.js.
As soon as the UserContext changes, the HomeMainPage will rerender to show updated information.

#### Parameters

-   `props` **{navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a HomeMainPage Component with scorllView consisting of many cards of tasks.

### SearchField

[UI/src/pages/HomePage.js:93-108](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/HomePage.js#L93-L108 "Source code on GitHub")

(Incompleted) SearchField lines up our app logo and a search bar that will search and return specific task card by keyword.

#### Parameters

-   `none`  

Returns **Component** => Render a logo lined up with a searchBar Component

### CardField

[UI/src/pages/HomePage.js:133-210](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/HomePage.js#L133-L210 "Source code on GitHub")

CardField will render the task information based on the task object passed by HomeMainPage,
and render the buttons to redirect to other pages corresponding to that specific task.

#### Parameters

-   `props` **{task: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object), navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** Object contains two key-value pair:<br>
     1\. props.task:
        {
             publisher: String,
             publisherUID: number,
             receiverUID: number,
             taskID: number,
             avatar: string,
             rating: number,
             coins: number,
             cost: number,
             datetime: datetime,
             title: string,
             description: string,
             img: string\[],
        }
    2\. props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a Card component of the task

### LoginPage

[UI/src/pages/LoginPage.js:14-61](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/LoginPage.js#L14-L61 "Source code on GitHub")

LoginPage is a page component that contains a button which will invokes the Google App Auth API
to acquire user information from user's Google account.
After the Google Auth API return the user information sucessfully, LoginPage will update the user information
using the callback function named changeUser declared in App.js

#### Parameters

-   `props` **{changeUser: [Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)}** props.changeUser is a callback function from App.js which can be used to change login user's properties.

Returns **Component** => Render a LoginPage to redirect the user to login using Google account

### MessagePage

[UI/src/pages/MessagePage.js:23-31](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/MessagePage.js#L23-L31 "Source code on GitHub")

MessagePage has a child componet ChatList which is one of the observer under the subject App.js.
It will be notified if there are new message from other users.
As soon as the variable chatList changed in App.js, MessagePage will rerender and update the new message for the corresponding ChatBox.
MessagePage also has basic navigation logic to jump between different ChatPage.

#### Parameters

-   `none`  

Returns **Component** => Render a MessagPage component with navigation logic

### ChatList

[UI/src/pages/MessagePage.js:40-107](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/MessagePage.js#L40-L107 "Source code on GitHub")

ChatList is an observer and a child component of MessagePage that will render a list of previous contacted user.

#### Parameters

-   `props` **{navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a ChatList component where each item of the list is a contact and is clickable and redirect to the ChatBox.

### PublishPage

[UI/src/pages/PublishPage.js:18-85](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/PublishPage.js#L18-L85 "Source code on GitHub")

PublishPage is not an observer as other pages. However, it will collect the new task inputs from the user.
Then, it will publish the new task and a new post request to the server. 
The server will then notify App.js as soon as it receives the new task information.

#### Parameters

-   `props` **{navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a PublishPage component with imagePicker and button to help post new task.

### publish

[UI/src/pages/PublishPage.js:97-145](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/PublishPage.js#L97-L145 "Source code on GitHub")

It will encapsulate the new task inputs and send a post request to the server to update the taskList.

#### Parameters

-   `title` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `description` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `cost` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 
-   `images` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** 
-   `userUID` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

### checkImagePermission

[UI/src/pages/PublishPage.js:153-162](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/PublishPage.js#L153-L162 "Source code on GitHub")

It will check whether the application is allowed to acess image library in the device.

#### Parameters

-   `none`  

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** 

### ImagePicker

[UI/src/pages/PublishPage.js:170-266](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/PublishPage.js#L170-L266 "Source code on GitHub")

ImagePicker is a helper component that generates four TouchableOpacity that allow user to upload up to four images for the new task.

#### Parameters

-   `props` **{setParentImageArray: [Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)}** props.setParentImageArray is a callback function that sets the parent component which is PublishPage's image array.

Returns **Component** => Render a ImagePicker to help user to upload up to four images

### TaskDetailPage

[UI/src/pages/TaskDetailPage.js:35-244](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/TaskDetailPage.js#L35-L244 "Source code on GitHub")

TaskDetailPage is a extended page that can be called by other pages to show more detail information for one task object.

#### Parameters

-   `props` **{route: {params: {task: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}}, navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** <br>
    1. props.route.params.task:
        {
             publisher: String,
             publisherUID: number,
             receiverUID: number,
             taskID: number,
             avatar: string,
             rating: number,
             coins: number,
             cost: number,
             datetime: datetime,
             title: string,
             description: string,
             img: string[],
        }
    2. props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a TaskDetailPage to show the details of one task.

### TaskPage

[UI/src/pages/TaskPage.js:23-32](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/TaskPage.js#L23-L32 "Source code on GitHub")

TaskPage contains the basic navigation logic to jump between differnt taskDetailPage and chatPage.

#### Parameters

-   `none`  

Returns **Component** => Render a TaskPage with navigation logic

### TaskMainPage

[UI/src/pages/TaskPage.js:42-84](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/TaskPage.js#L42-L84 "Source code on GitHub")

TaskMainPage is an observer under the subject of App.js. It contains a list of cards of tasks.
As soon as taskList changed in App.js, the TaskMainPage will rerender its card of the tasks.

#### Parameters

-   `props` **{navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a TaskMainPage with ScrollView consisting of cards of tasks.

### TaskCard

[UI/src/pages/TaskPage.js:109-124](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/TaskPage.js#L109-L124 "Source code on GitHub")

TaskCard will render the task information based on the task object passed by HomeMainPage similar to CardField but with different styles.

#### Parameters

-   `props` **{task: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object), navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** Object contains two key-value pair:<br>
     1\. props.task:
        {
             publisher: String,
             publisherUID: number,
             receiverUID: number,
             taskID: number,
             avatar: string,
             rating: number,
             coins: number,
             cost: number,
             datetime: datetime,
             title: string,
             description: string,
             img: string\[],
        }
    2\. props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a TaskCard that is correspoinding to one task.

### UserDetailPage

[UI/src/pages/UserDetailPage.js:18-129](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/UserDetailPage.js#L18-L129 "Source code on GitHub")

Show the user's detail information by sending post request and fetch the user data from the server.

#### Parameters

-   `props` **{route: {params: {userUID: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)}}, navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** <br>
    1. props.route.params.userUID is used to send post request to the server to acquire the user information.
    2. props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a UserDetailPage to show the details of the user with the given userUID.

### getUser

[UI/src/pages/UserDetailPage.js:138-165](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/UserDetailPage.js#L138-L165 "Source code on GitHub")

Send a post request to the sever to acquire the user object by userUID.

#### Parameters

-   `userUID` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** 

Returns **{user: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** 

### UserPage

[UI/src/pages/UserPage.js:19-94](https://github.com/dliang090222/WeHelp/blob/623b6b6f20da031c175e3461cd4003c348add30c/UI/src/pages/UserPage.js#L19-L94 "Source code on GitHub")

Show the information of current login user.

#### Parameters

-   `props` **{navigation: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)}** props.navigation is generated by the stack navigator in React-Navigation used to redirect to other pages.

Returns **Component** => Render a UserPage to show the information of current login user.


## Back-end API
[APIs for http requests](server/docs/views.html) or [view it on our website](http://34.94.101.183/media/views.html)

Python: module views 

   
 **views**

[index](.)  
[/home/dliang/WeHelp/server/WeHelpServer/views.py](file:/home/dliang/WeHelp/server/WeHelpServer/views.py)

We only provide one endpoint for http requests: /WeHelp/  
We differ the requests base on the provided 'func' key in json body for regular POST requests or in POST for form-data  
These are possible 'func' values:  
1. signIn - User sign in to server using email   
2. getUser - return infomation of an existing User  
3. sendLocation - send location to other user  
4. sendMessage - send message to other user   
5. getChatList - returns all chat infomation belong to a User   
6. getMessage - returns all messages of a chat   
7. getActiveTask - returns infomation of all Task that is open   
8. getAcceptTask - returns infomation of all Task that is accpeted by given User   
9. getPublishTask - returns infomation of all Task that is published by given User   
10. acceptTask - User accpet a Task  
11. cancelAccept - User cancel accpetion of a Task  
12. deleteTask - User delete a Task   
13. finishTask - User confirm a Task is finished  
14. sendRating - give rating to User  
15. changeIcon - User change icon/avatar. form-data POST request   
16. sendTask - User publish a task. form-data POST request

   
**Functions**

 

 

**acceptTask**(body)

Allow users accept tasks only if they are not the publisher and the task is not accepted by someone else  
   
Parameters  
\----------  
body: {'UID': int, 'taskID': int}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
})

**cancelAccept**(body)

Allow users to give up acception of tasks only if they accpeted the tasks  
   
Parameters  
\----------  
body: {'UID': int, 'taskID': int}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
})

**changeIcon**(request)

Allow Users to change their icons/avatars and returns the uri of stored image  
   
Parameters  
\----------  
request: HttpRequests   
         whose POST contains {'UID': int}  
         and FILES contains {'file': a image file stream}  
   
Returns  
\-------  
JsonResponse({'success': int, 'uri': string})

**deleteTask**(body)

Allow users to remove tasks only if they are the publisher of tasks and tasks are not yet finished.  
   
Parameters  
\----------  
body: {'UID': int, 'taskID': int}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
})

**finishTask**(body)

Allow users to confirm tasks are finish only if they are the publisher of tasks and tasks are accepted by someone.  
   
Parameters  
\----------  
body: {'UID': int, 'taskID': int}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
})

**getAcceptTask**(body)

returns infomation of all Task that is accepted by the given User  
   
Parameters  
\----------  
body: {'UID': int}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
    'taskList': \[{   
        'taskID': int, 'UID': int,   
        'acceptorUID: int, 'title': string,  
        'body': string, 'cost': int,  
        'datetime': string, 'images': \[string\*\]  
    }\]   
})

**getActiveTask**(body)

returns infomation of all Task that is open  
   
Parameters  
\----------  
body: {}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
    'taskList': \[{   
        'taskID': int, 'UID': int,   
        'acceptorUID: int, 'title': string,  
        'body': string, 'cost': int,  
        'datetime': string, 'images': \[string\*\]  
    }\]   
})

**getChatList**(body)

returns all chat infomation belong to a User.  
   
Parameters  
\----------  
body: {'UID': int}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
    'chatList': \[{   
        'chatID': int, 'avatarURL': string,   
        'name': string, 'last\_message': string,   
        'datetime': string   
    }\]   
})

**getMessage**(body)

returns all messages inside a chat  
   
Parameters  
\----------  
body: {'chatID': int}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
    'messageList': \[{   
        'UID': int, 'message': string,   
        'datetime': string   
    }\]   
})

**getPublishTask**(body)

returns infomation of all Task that is published by the given User  
   
Parameters  
\----------  
body: {'UID': int}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
    'taskList': \[{   
        'taskID': int, 'UID': int,   
        'acceptorUID: int, 'title': string,  
        'body': string, 'cost': int,  
        'datetime': string, 'images': \[string\*\]  
    }\]   
})

**getUser**(body)

return infomation of an existing User  
   
Parameters  
\----------  
body: {'UID': int}  
   
Returns  
\-------  
JsonResponse({  
    'UID': int, 'coins': int,  
    'icon': string, 'rating': int,  
    'publish\_count': int,   
    'finish\_count': int,  
    'contributions': \[string\*\],  
    'success': int  
    })

**index**(request)

A top level function to determine what kind of request is making base on the 'func' key  
   
Parameters  
\----------  
request: HttpRequests   
   
Returns  
\-------  
JsonResponse({})

**sendLocation**(body)

send location to other user through channel\_layer  
   
Parameters  
\----------  
body: {'senderUID': int, 'receiverUID': int,   
       'longitude': double, 'latitude': double}  
   
Returns  
\-------  
JsonResponse({'success': int})

**sendMessage**(body)

send message to other user.   
Stores the message into chat and send to receiver client through channel\_layer  
   
Parameters  
\----------  
body: {'senderUID': int, 'receiverUID': int, 'message': string}  
   
Returns  
\-------  
JsonResponse({'success': int})

**sendRating**(body)

give rating to a User.  
   
Parameters  
\----------  
body: {'UID': int, 'rating': double}  
   
Returns  
\-------  
JsonResponse({  
    'success': int,   
})

**sendTask**(request)

Allow Users to publish task  
   
Parameters  
\----------  
request: HttpRequests   
         whose POST contains {'UID': int, 'body': string, 'title': string, 'cost': int, 'image\_count': int}  
         and FILES contains number of files depends on image\_count: {'0': image file stream, '1': image file stream, ...}  
   
Returns  
\-------  
JsonResponse({'success': int})

**signIn**(body)

User sign in to server using email  
   
Parameters  
\----------  
body: {'email': string, 'name': string, 'icon': string}  
   
Returns  
\-------  
JsonResponse({  
    'UID': int, 'coins': int,  
    'icon': string, 'rating': int,  
    'publish\_count': int, 'finish\_count': int,  
    'contributions': \[string\*\]  
    })

**upload**(request)

interface to handle requests that are 'multipart/form-data' content type.  
   
Parameters  
\----------  
request: HttpRequests object  
   
Returns  
\-------  
JsonResponse
